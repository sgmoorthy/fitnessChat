// Small shim: the actual client-side app was moved to public/app.js
// Keep this file small to avoid confusion. For the full app, open public/app.js

console.log('app.js moved to public/app.js ‚Äî open public/app.js to view the client code');

// Minimal no-op exports for tools that may import this file in Node contexts
if (typeof module !== 'undefined' && module.exports) {
  module.exports = {};
}
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                },
                {
                    name: "Mi6 Functional Trainer",
                    category: "Functional",
                    features: ["360-degree rotation", "Dual weight stacks", "Versatile exercises"],
                    useCase: "Functional training studios",
                    priceRange: "Premium (‚Çπ150k+)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                },
                {
                    name: "Mi7 Smith",
                    category: "Strength",
                    features: ["Ultra-lite bar (30lbs)", "Functional training", "Safety catches"],
                    useCase: "All-round strength training",
                    priceRange: "Premium (‚Çπ150k+)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                },
                {
                    name: "Multi Stack Stations",
                    category: "Multi-Station",
                    features: ["Multiple users", "Space-efficient", "Complete gym solution"],
                    useCase: "Commercial gyms, Multiple simultaneous users",
                    priceRange: "Premium (‚Çπ150k+)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                }
            ]
        },
        freemotion: {
            name: "FreeMotion Cardio",
            country: "USA",
            specialty: "Premium Cardio Equipment",
            products: [
                {
                    name: "t22.9 REFLEX Treadmill",
                    model: "FMTL70920",
                    category: "Cardio",
                    specs: {
                        speed: "0-15 mph (0-24 km/h)",
                        incline: "0-15%",
                        display: "22 inch HD Touchscreen",
                        weightCapacity: "400 lbs (181 kg)"
                    },
                    features: ["iFIT Integration", "Impact-reducing deck", "Heart rate monitoring", "Google Maps enabled"],
                    priceRange: "Premium (‚Çπ150k+)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                },
                {
                    name: "r22.9 Recumbent Bike",
                    model: "FMEX82520",
                    category: "Cardio",
                    specs: {
                        resistanceLevels: "1-24",
                        display: "22 inch HD Touchscreen",
                        weightCapacity: "400 lbs (181 kg)"
                    },
                    features: ["Back-friendly design", "Step-Thru accessible", "iFIT on-demand workouts"],
                    priceRange: "Premium (‚Çπ150k+)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                },
                {
                    name: "CoachBike",
                    model: "FMEX84821",
                    category: "Cardio",
                    features: ["Incline/Decline (-10% to +20%)", "SMR magnetic resistance", "Professional training"],
                    priceRange: "Premium (‚Çπ150k+)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                },
                {
                    name: "e22.9 Elliptical",
                    model: "FMEL84420",
                    category: "Cardio",
                    features: ["Full-body low-impact workout", "22-inch HD display", "iFIT enabled"],
                    priceRange: "Premium (‚Çπ150k+)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                }
            ]
        },
        tunturi: {
            name: "Tunturi Fitness",
            country: "Netherlands",
            specialty: "European Engineering Quality",
            products: [
                {
                    name: "Cardio Fit Series",
                    category: "Cardio",
                    features: ["Durable construction", "Wide resistance range", "Multiple workout programs"],
                    priceRange: "Mid-range (‚Çπ75k-‚Çπ150k)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                },
                {
                    name: "T90 Motorised Treadmill",
                    category: "Cardio",
                    specs: {
                        motor: "5.0 HP AC",
                        speed: "0.8-24 km/h",
                        incline: "0-15%",
                        runningArea: "153 x 55 cm",
                        maxUserWeight: "150 kg"
                    },
                    features: ["T-Flex Comfort+ shock absorption", "Bluetooth enabled", "LCD display"],
                    priceRange: "Mid-range (‚Çπ75k-‚Çπ150k)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                }
            ]
        },
        concept2: {
            name: "Concept2",
            country: "USA",
            specialty: "Premium Indoor Rowing",
            products: [
                {
                    name: "RowErg",
                    category: "Rowing",
                    specs: {
                        length: "244 cm",
                        width: "61 cm",
                        seatHeight: "36 cm (standard) or 51 cm (tall)",
                        maxUserWeight: "227 kg"
                    },
                    features: ["Full-body low-impact workout", "PM5 Monitor", "Adjustable footrests", "Quick-release storage"],
                    priceRange: "Premium (‚Çπ150k+)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                }
            ]
        },
        energie: {
            name: "Energie Fitness",
            country: "India",
            specialty: "Quality Fitness Solutions",
            products: [
                {
                    name: "ETB-17 Functional Trainer",
                    category: "Functional",
                    specs: {
                        dimensions: "1050 x 1950 x 2300 mm",
                        weight: "382 kg",
                        weightStack: "200 kg"
                    },
                    features: ["Heavy-duty frame", "Dual weight stacks", "10+ adjustments", "Commercial grade"],
                    priceRange: "Mid-range (‚Çπ75k-‚Çπ150k)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                },
                {
                    name: "PRO-001 Premium Chest Press",
                    category: "Single Station",
                    features: ["Ergonomic design", "Adjustable seat", "Smooth movement"],
                    priceRange: "Budget (Under ‚Çπ75k)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                },
                {
                    name: "PRO-002 Incline Chest Press",
                    category: "Single Station",
                    features: ["Incline angle", "Professional grade", "Durable construction"],
                    priceRange: "Budget (Under ‚Çπ75k)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                },
                {
                    name: "PRO-003 Shoulder Press",
                    category: "Single Station",
                    features: ["Shoulder-focused", "Adjustable settings", "Safe operation"],
                    priceRange: "Budget (Under ‚Çπ75k)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                },
                {
                    name: "PRO-009 Leg Press 45¬∞",
                    category: "Single Station",
                    features: ["45-degree angle", "Heavy weight capacity", "Lower body focus"],
                    priceRange: "Mid-range (‚Çπ75k-‚Çπ150k)",
                    link: "https://www.energyfitness.in/e-catalogue/index.php"
                }
            ]
        }
    }
};

// Conversation history
let conversationHistory = [];

// Initialize chat
function initializeChat() {
    addBotMessage(
        `Welcome to Energy Fitness Equipment Catalog Assistant! üëã\n\nI'm here to help you find the perfect fitness equipment. I can assist you with:\n\n‚úì Product information and specifications\n‚úì Equipment comparisons\n‚úì Browse by category or brand\n‚úì Price estimates and recommendations\n‚úì Gym setup consultation\n\nHow can I help you today?`
    );
}

// Add message to chat
function addMessage(text, isUser = false, htmlContent = null) {
    const messagesContainer = document.getElementById('chatMessages');
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;

    const avatar = document.createElement('div');
    avatar.className = 'message-avatar';
    avatar.textContent = isUser ? 'U' : 'EF';

    const contentDiv = document.createElement('div');
    contentDiv.className = 'message-content';

    if (htmlContent) {
        contentDiv.innerHTML = htmlContent;
    } else {
        const textDiv = document.createElement('div');
        textDiv.className = 'message-text';
        textDiv.textContent = text;
        contentDiv.appendChild(textDiv);
    }

    messageDiv.appendChild(avatar);
    messageDiv.appendChild(contentDiv);
    messagesContainer.appendChild(messageDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

function addBotMessage(text, htmlContent = null) {
    addMessage(text, false, htmlContent);
}

function addUserMessage(text) {
    addMessage(text, true);
}

// Show typing indicator
function showTypingIndicator() {
    const messagesContainer = document.getElementById('chatMessages');
    const typingDiv = document.createElement('div');
    typingDiv.className = 'message bot';
    typingDiv.id = 'typingIndicator';

    const avatar = document.createElement('div');
    avatar.className = 'message-avatar';
    avatar.textContent = 'EF';

    const contentDiv = document.createElement('div');
    contentDiv.className = 'message-content';
    contentDiv.innerHTML = '<div class="typing-indicator"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div>';

    typingDiv.appendChild(avatar);
    typingDiv.appendChild(contentDiv);
    messagesContainer.appendChild(typingDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

function removeTypingIndicator() {
    const typingIndicator = document.getElementById('typingIndicator');
    if (typingIndicator) {
        typingIndicator.remove();
    }
}

// Process user query
function processQuery(query) {
    const lowerQuery = query.toLowerCase();

    // Store in conversation history
    conversationHistory.push({ role: 'user', message: query });

    // Compare products
    if (lowerQuery.includes('compare') || lowerQuery.includes('vs') || lowerQuery.includes('versus')) {
        return handleComparison(query);
    }

    // Browse categories
    if (lowerQuery.includes('strength equipment') || lowerQuery.includes('browse strength')) {
        return browseCategoryEquipment('strength');
    }

    if (lowerQuery.includes('cardio equipment') || lowerQuery.includes('browse cardio')) {
        return browseCategoryEquipment('cardio');
    }

    // View brands
    if (lowerQuery.includes('view all brands') || lowerQuery.includes('brands') || lowerQuery.includes('manufacturers')) {
        return showAllBrands();
    }

    // Price estimates
    if (lowerQuery.includes('price') || lowerQuery.includes('cost') || lowerQuery.includes('budget')) {
        return showPriceRanges();
    }

    // Setup gym
    if (lowerQuery.includes('setup') || lowerQuery.includes('start a gym') || lowerQuery.includes('open a gym')) {
        return handleGymSetup();
    }

    // Best treadmill
    if (lowerQuery.includes('best treadmill') || lowerQuery.includes('top treadmill')) {
        return showBestTreadmills();
    }

    // Commercial vs Home
    if (lowerQuery.includes('commercial vs home') || lowerQuery.includes('commercial or home')) {
        return explainCommercialVsHome();
    }

    // Specific brand search
    for (const brandKey in equipmentDatabase.brands) {
        const brand = equipmentDatabase.brands[brandKey];
        if (lowerQuery.includes(brandKey) || lowerQuery.includes(brand.name.toLowerCase())) {
            return showBrandProducts(brandKey);
        }
    }

    // Specific product search
    const product = findProduct(query);
    if (product) {
        return showProductDetails(product);
    }

    // Default response
    return `I'd be happy to help you with that! Here are some things I can assist with:\n\n‚Ä¢ Browse equipment by category (Strength, Cardio, Functional)\n‚Ä¢ View products from specific brands (HOIST, FreeMotion, Tunturi, Concept2, Energie Fitness)\n‚Ä¢ Compare different equipment models\n‚Ä¢ Get price estimates and recommendations\n‚Ä¢ Help you setup a gym\n\nCould you please be more specific about what you're looking for?`;
}

// Find product
function findProduct(query) {
    const lowerQuery = query.toLowerCase();
    
    for (const brandKey in equipmentDatabase.brands) {
        const brand = equipmentDatabase.brands[brandKey];
        for (const product of brand.products) {
            if (lowerQuery.includes(product.name.toLowerCase()) || 
                (product.model && lowerQuery.includes(product.model.toLowerCase()))) {
                return { ...product, brandName: brand.name, brandKey };
            }
        }
    }
    return null;
}

// Show product details
function showProductDetails(product) {
    let html = `<div class="product-card"><div class="product-header">${product.name}</div>`;
    
    html += `<div class="product-specs">`;
    html += `<div class="spec-item"><span class="spec-label">Brand:</span><span class="spec-value">${product.brandName}</span></div>`;
    html += `<div class="spec-item"><span class="spec-label">Category:</span><span class="spec-value">${product.category}</span></div>`;
    
    if (product.model) {
        html += `<div class="spec-item"><span class="spec-label">Model:</span><span class="spec-value">${product.model}</span></div>`;
    }
    
    if (product.priceRange) {
        html += `<div class="spec-item"><span class="spec-label">Price Range:</span><span class="spec-value">${product.priceRange}</span></div>`;
    }
    
    if (product.specs) {
        for (const [key, value] of Object.entries(product.specs)) {
            const formattedKey = key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
            html += `<div class="spec-item"><span class="spec-label">${formattedKey}:</span><span class="spec-value">${value}</span></div>`;
        }
    }
    
    if (product.features && product.features.length > 0) {
        html += `</div><div style="margin-top: 12px;"><strong>Key Features:</strong><ul class="feature-list">`;
        product.features.forEach(feature => {
            html += `<li>${feature}</li>`;
        });
        html += `</ul></div>`;
    }
    
    if (product.useCase) {
        html += `<div style="margin-top: 12px;"><strong>Best For:</strong> ${product.useCase}</div>`;
    }
    
    html += `<a href="${product.link}" target="_blank" class="product-link">View on Energy Fitness Website ‚Üí</a>`;
    html += `</div>`;
    
    return html;
}

// Handle comparison
function handleComparison(query) {
    const products = [];
    const lowerQuery = query.toLowerCase();
    
    // Try to find multiple products
    for (const brandKey in equipmentDatabase.brands) {
        const brand = equipmentDatabase.brands[brandKey];
        for (const product of brand.products) {
            if (lowerQuery.includes(product.name.toLowerCase()) || 
                (product.model && lowerQuery.includes(product.model.toLowerCase()))) {
                products.push({ ...product, brandName: brand.name, brandKey });
            }
        }
    }
    
    if (products.length >= 2) {
        return createComparisonTable(products.slice(0, 3));
    } else if (products.length === 1) {
        return `I found ${products[0].name}, but I need at least one more product to compare. Could you specify another product?`;
    } else {
        return `I couldn't identify specific products to compare. Please mention the product names you'd like to compare. For example: "Compare FreeMotion t22.9 treadmill vs Tunturi T90"`;
    }
}

// Create comparison table
function createComparisonTable(products) {
    let html = `<div style="margin-bottom: 12px;"><strong>Comparison Report</strong></div>`;
    html += `<table class="comparison-table">`;
    
    // Header row
    html += `<tr><th>Specification</th>`;
    products.forEach(p => {
        html += `<th>${p.name}</th>`;
    });
    html += `</tr>`;
    
    // Brand row
    html += `<tr><td><strong>Brand</strong></td>`;
    products.forEach(p => {
        html += `<td>${p.brandName}</td>`;
    });
    html += `</tr>`;
    
    // Category row
    html += `<tr><td><strong>Category</strong></td>`;
    products.forEach(p => {
        html += `<td>${p.category}</td>`;
    });
    html += `</tr>`;
    
    // Price range row
    html += `<tr><td><strong>Price Range</strong></td>`;
    products.forEach(p => {
        html += `<td>${p.priceRange || 'Contact for pricing'}</td>`;
    });
    html += `</tr>`;
    
    // Features row
    html += `<tr><td><strong>Key Features</strong></td>`;
    products.forEach(p => {
        html += `<td>`;
        if (p.features && p.features.length > 0) {
            html += `<ul style="margin: 0; padding-left: 16px; list-style: disc;">`;
            p.features.slice(0, 3).forEach(f => {
                html += `<li style="margin: 4px 0;">${f}</li>`;
            });
            html += `</ul>`;
        }
        html += `</td>`;
    });
    html += `</tr>`;
    
    // Use case row
    html += `<tr><td><strong>Best For</strong></td>`;
    products.forEach(p => {
        html += `<td>${p.useCase || 'General use'}</td>`;
    });
    html += `</tr>`;
    
    html += `</table>`;
    
    // Recommendation
    html += `<div style="margin-top: 16px; padding: 12px; background: var(--color-bg-3); border-radius: 8px;">`;
    html += `<strong>üí° Recommendation:</strong><br>`;
    html += `All these products are excellent choices. Your decision should be based on:<br>`;
    html += `‚Ä¢ <strong>Budget:</strong> ${products[0].priceRange}<br>`;
    html += `‚Ä¢ <strong>Space:</strong> Consider equipment dimensions<br>`;
    html += `‚Ä¢ <strong>Use case:</strong> Commercial vs home gym<br><br>`;
    html += `Visit the Energy Fitness catalog for complete specifications and current pricing.`;
    html += `</div>`;
    
    return html;
}

// Browse category equipment
function browseCategoryEquipment(category) {
    const allProducts = [];
    
    for (const brandKey in equipmentDatabase.brands) {
        const brand = equipmentDatabase.brands[brandKey];
        for (const product of brand.products) {
            if (product.category.toLowerCase().includes(category.toLowerCase()) ||
                (category === 'cardio' && ['Cardio', 'Rowing'].includes(product.category))) {
                allProducts.push({ ...product, brandName: brand.name });
            }
        }
    }
    
    if (allProducts.length === 0) {
        return `No ${category} equipment found. Please try another category.`;
    }
    
    let html = `<div style="margin-bottom: 12px;"><strong>${category.charAt(0).toUpperCase() + category.slice(1)} Equipment</strong></div>`;
    html += `<div class="category-grid">`;
    
    allProducts.forEach(product => {
        html += `<div class="category-item" onclick="handleQuickAction('Tell me about ${product.name}')">`;
        html += `<div class="category-name">${product.name}</div>`;
        html += `<div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">${product.brandName}</div>`;
        html += `<div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 4px;">${product.priceRange || 'Contact for pricing'}</div>`;
        html += `</div>`;
    });
    
    html += `</div>`;
    html += `<div style="margin-top: 16px; font-size: 13px; color: var(--color-text-secondary);">Click on any equipment to see detailed specifications.</div>`;
    
    return html;
}

// Show all brands
function showAllBrands() {
    let html = `<div style="margin-bottom: 12px;"><strong>Our Premium Brands</strong></div>`;
    html += `<div class="category-grid">`;
    
    for (const brandKey in equipmentDatabase.brands) {
        const brand = equipmentDatabase.brands[brandKey];
        html += `<div class="category-item" onclick="handleQuickAction('Show me ${brand.name} products')">`;
        html += `<div class="category-name">${brand.name}</div>`;
        html += `<div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">${brand.country}</div>`;
        html += `<div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 4px;">${brand.specialty}</div>`;
        html += `<div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 8px;">${brand.products.length} products</div>`;
        html += `</div>`;
    }
    
    html += `</div>`;
    html += `<div style="margin-top: 16px; font-size: 13px; color: var(--color-text-secondary);">Click on any brand to explore their products.</div>`;
    
    return html;
}

// Show brand products
function showBrandProducts(brandKey) {
    const brand = equipmentDatabase.brands[brandKey];
    
    if (!brand) {
        return `Brand not found. Please try another brand.`;
    }
    
    let html = `<div style="margin-bottom: 12px;"><strong>${brand.name}</strong></div>`;
    html += `<div style="margin-bottom: 16px; font-size: 13px; color: var(--color-text-secondary);">${brand.country} ‚Ä¢ ${brand.specialty}</div>`;
    html += `<div class="category-grid">`;
    
    brand.products.forEach(product => {
        html += `<div class="category-item" onclick="handleQuickAction('Tell me about ${product.name}')">`;
        html += `<div class="category-name">${product.name}</div>`;
        html += `<div style="font-size: 12px; color: var(--color-text-secondary); margin-top: 4px;">${product.category}</div>`;
        html += `<div style="font-size: 11px; color: var(--color-text-secondary); margin-top: 4px;">${product.priceRange || 'Contact for pricing'}</div>`;
        html += `</div>`;
    });
    
    html += `</div>`;
    html += `<div style="margin-top: 16px; font-size: 13px; color: var(--color-text-secondary);">Click on any product to see detailed specifications.</div>`;
    
    return html;
}

// Show price ranges
function showPriceRanges() {
    let html = `<div style="margin-bottom: 12px;"><strong>Equipment Price Ranges</strong></div>`;
    html += `<div style="margin-bottom: 16px; font-size: 13px; color: var(--color-text-secondary);">Here are approximate price ranges for our equipment:</div>`;
    
    const priceCategories = {
        'Budget (Under ‚Çπ75k)': [],
        'Mid-range (‚Çπ75k-‚Çπ150k)': [],
        'Premium (‚Çπ150k+)': []
    };
    
    for (const brandKey in equipmentDatabase.brands) {
        const brand = equipmentDatabase.brands[brandKey];
        for (const product of brand.products) {
            if (product.priceRange) {
                priceCategories[product.priceRange].push({ ...product, brandName: brand.name });
            }
        }
    }
    
    for (const [range, products] of Object.entries(priceCategories)) {
        if (products.length > 0) {
            html += `<div style="background: var(--color-bg-2); border: 1px solid var(--color-card-border); border-radius: 8px; padding: 16px; margin-bottom: 12px;">`;
            html += `<div style="font-weight: 600; margin-bottom: 8px;">${range}</div>`;
            html += `<ul style="margin: 0; padding-left: 20px;">`;
            products.forEach(p => {
                html += `<li style="margin: 4px 0; font-size: 13px;">${p.name} (${p.brandName})</li>`;
            });
            html += `</ul></div>`;
        }
    }
    
    html += `<div style="margin-top: 16px; padding: 12px; background: var(--color-bg-3); border-radius: 8px; font-size: 13px;">`;
    html += `<strong>Note:</strong> Prices may vary based on specifications, customization, and current offers. Please visit <a href="https://www.energyfitness.in/e-catalogue/index.php" target="_blank" style="color: var(--color-primary);">Energy Fitness</a> for exact pricing.`;
    html += `</div>`;
    
    return html;
}

// Handle gym setup
function handleGymSetup() {
    let html = `<div style="margin-bottom: 12px;"><strong>üèãÔ∏è Gym Setup Consultation</strong></div>`;
    html += `<div style="margin-bottom: 16px;">Great! I'd love to help you setup your gym. Here's what we need to consider:</div>`;
    
    html += `<div style="background: var(--color-bg-1); border: 1px solid var(--color-card-border); border-radius: 8px; padding: 16px; margin-bottom: 12px;">`;
    html += `<div style="font-weight: 600; margin-bottom: 8px;">1. Space &amp; Size</div>`;
    html += `<div style="font-size: 13px;">‚Ä¢ Home gym (150-500 sq ft)<br>‚Ä¢ Boutique studio (500-2000 sq ft)<br>‚Ä¢ Commercial gym (2000+ sq ft)</div>`;
    html += `</div>`;
    
    html += `<div style="background: var(--color-bg-2); border: 1px solid var(--color-card-border); border-radius: 8px; padding: 16px; margin-bottom: 12px;">`;
    html += `<div style="font-weight: 600; margin-bottom: 8px;">2. Budget Range</div>`;
    html += `<div style="font-size: 13px;">‚Ä¢ Starter: ‚Çπ2-5 lakhs<br>‚Ä¢ Professional: ‚Çπ5-15 lakhs<br>‚Ä¢ Premium: ‚Çπ15+ lakhs</div>`;
    html += `</div>`;
    
    html += `<div style="background: var(--color-bg-3); border: 1px solid var(--color-card-border); border-radius: 8px; padding: 16px; margin-bottom: 12px;">`;
    html += `<div style="font-weight: 600; margin-bottom: 8px;">3. Equipment Focus</div>`;
    html += `<div style="font-size: 13px;">‚Ä¢ Cardio-focused (60% cardio, 40% strength)<br>‚Ä¢ Strength-focused (40% cardio, 60% strength)<br>‚Ä¢ Balanced (50-50 mix)</div>`;
    html += `</div>`;
    
    html += `<div style="margin-top: 16px; padding: 12px; background: var(--color-bg-5); border-radius: 8px;">`;
    html += `<strong>Recommended Starter Package:</strong><br><br>`;
    html += `<strong>Cardio Zone:</strong> 2-3 Treadmills, 1-2 Bikes, 1 Elliptical<br>`;
    html += `<strong>Strength Zone:</strong> Multi-station gym, Functional trainer, Free weights<br>`;
    html += `<strong>Brands:</strong> Mix of FreeMotion, HOIST, and Energie Fitness<br><br>`;
    html += `Would you like specific recommendations based on your space and budget?`;
    html += `</div>`;
    
    return html;
}

// Show best treadmills
function showBestTreadmills() {
    const treadmills = [];
    
    for (const brandKey in equipmentDatabase.brands) {
        const brand = equipmentDatabase.brands[brandKey];
        for (const product of brand.products) {
            if (product.name.toLowerCase().includes('treadmill')) {
                treadmills.push({ ...product, brandName: brand.name });
            }
        }
    }
    
    let html = `<div style="margin-bottom: 12px;"><strong>üèÉ Top Treadmills</strong></div>`;
    
    treadmills.forEach((treadmill, index) => {
        html += `<div style="background: var(--color-bg-${(index % 4) + 1}); border: 1px solid var(--color-card-border); border-radius: 8px; padding: 16px; margin-bottom: 12px;">`;
        html += `<div style="font-weight: 600; margin-bottom: 8px;">${treadmill.name}</div>`;
        html += `<div style="font-size: 13px; color: var(--color-text-secondary); margin-bottom: 8px;">${treadmill.brandName} ‚Ä¢ ${treadmill.priceRange}</div>`;
        
        if (treadmill.specs) {
            html += `<div style="font-size: 13px; margin-bottom: 8px;">`;
            if (treadmill.specs.speed) html += `<strong>Speed:</strong> ${treadmill.specs.speed}<br>`;
            if (treadmill.specs.incline) html += `<strong>Incline:</strong> ${treadmill.specs.incline}<br>`;
            if (treadmill.specs.display) html += `<strong>Display:</strong> ${treadmill.specs.display}`;
            html += `</div>`;
        }
        
        if (treadmill.features && treadmill.features.length > 0) {
            html += `<ul style="margin: 8px 0 0 0; padding-left: 20px; font-size: 12px;">`;
            treadmill.features.slice(0, 3).forEach(f => {
                html += `<li style="margin: 2px 0;">${f}</li>`;
            });
            html += `</ul>`;
        }
        
        html += `<button class="quick-action-btn" style="margin-top: 12px;" onclick="handleQuickAction('Tell me about ${treadmill.name}')">View Details</button>`;
        html += `</div>`;
    });
    
    return html;
}

// Explain commercial vs home
function explainCommercialVsHome() {
    let html = `<div style="margin-bottom: 12px;"><strong>Commercial vs Home Gym Equipment</strong></div>`;
    
    html += `<table class="comparison-table">`;
    html += `<tr><th>Feature</th><th>Commercial Grade</th><th>Home Grade</th></tr>`;
    html += `<tr><td><strong>Durability</strong></td><td>Heavy-duty, 8-16 hours/day use</td><td>Light-moderate, 1-3 hours/day use</td></tr>`;
    html += `<tr><td><strong>Warranty</strong></td><td>5-10 years on frame, 1-3 years parts</td><td>1-5 years limited warranty</td></tr>`;
    html += `<tr><td><strong>Price Range</strong></td><td>‚Çπ150k - ‚Çπ500k+ per unit</td><td>‚Çπ30k - ‚Çπ150k per unit</td></tr>`;
    html += `<tr><td><strong>Weight Capacity</strong></td><td>180-250 kg</td><td>100-150 kg</td></tr>`;
    html += `<tr><td><strong>Features</strong></td><td>Advanced consoles, tracking, connectivity</td><td>Basic to intermediate features</td></tr>`;
    html += `<tr><td><strong>Footprint</strong></td><td>Larger, more stable</td><td>Compact, space-saving</td></tr>`;
    html += `</table>`;
    
    html += `<div style="margin-top: 16px; padding: 12px; background: var(--color-bg-3); border-radius: 8px;">`;
    html += `<strong>üí° Recommendation:</strong><br><br>`;
    html += `<strong>Choose Commercial if:</strong><br>`;
    html += `‚Ä¢ Opening a gym or studio<br>`;
    html += `‚Ä¢ Multiple daily users expected<br>`;
    html += `‚Ä¢ Need maximum durability<br><br>`;
    html += `<strong>Choose Home if:</strong><br>`;
    html += `‚Ä¢ Personal/family use only<br>`;
    html += `‚Ä¢ Limited space<br>`;
    html += `‚Ä¢ Budget-conscious<br><br>`;
    html += `<strong>Top Brands:</strong><br>`;
    html += `Commercial: HOIST, FreeMotion, Concept2<br>`;
    html += `Home: Tunturi, Energie Fitness PRO Series`;
    html += `</div>`;
    
    return html;
}

// Send message
function sendMessage() {
    const input = document.getElementById('chatInput');
    const message = input.value.trim();
    
    if (!message) return;
    
    addUserMessage(message);
    input.value = '';
    
    showTypingIndicator();
    
    setTimeout(() => {
        removeTypingIndicator();
        const response = processQuery(message);
        
        if (response.includes('<')) {
            addBotMessage('', response);
        } else {
            addBotMessage(response);
        }
        
        conversationHistory.push({ role: 'bot', message: response });
    }, 800);
}

// Handle quick action
function handleQuickAction(action) {
    const input = document.getElementById('chatInput');
    input.value = action;
    sendMessage();
}

// Event listeners
document.getElementById('chatInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        sendMessage();
    }
});

// Initialize on load
window.addEventListener('load', () => {
    initializeChat();
});